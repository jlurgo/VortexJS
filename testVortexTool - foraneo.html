<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Prueba de vx</title>
		<style>
			div{
				border: solid 1px;
			}
		</style>
		
	</head>
	
	<body>
		<div id="btn_setWhen">vx.when <b>(test.jt.vx.when)</b></div>
		<div id="btn_setWhenPara">vx.when - para <b>(test.jt.vx.when.para)</b></div>
		<div id="btn_setWhenPreguntaPara">vx.when - - pregunta - para <b>(test.jt.vx.when.pregunta.para)</b></div>
		<div id="btn_setWhenParaPreguntaPara">vx.when - para - pregunta - para <b>(test.jt.vx.when.para.pregunta.para)</b></div>
		<div id="btn_setWhenParaPreguntaParaDe">vx.when - para - pregunta - para de <b>(test.jt.vx.when.para.pregunta.para.de)</b></div>
    </body>
    
	
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
	<script type="text/javascript" src="Cryptico.min.js"></script> 
	
    <script type="text/javascript" src="FiltrosYTransformaciones.js"></script>
    <script type="text/javascript" src="NodoClienteHTTP.js"></script> 
    <script type="text/javascript" src="ClonadorDeObjetos.js"></script> 
    <script type="text/javascript" src="GeneradorDeIdMensaje.js"></script> 
    <script type="text/javascript" src="NodoClienteHTTP.js"></script>  
    <script type="text/javascript" src="NodoPortalBidi.js"></script> 
    <script type="text/javascript" src="NodoPortalBidiMonoFiltro.js"></script> 
    <script type="text/javascript" src="NodoRouter.js"></script> 
    <script type="text/javascript" src="PataConectora.js"></script> 
    <script type="text/javascript" src="NodoConectorSocket.js"></script>
    <script type="text/javascript" src="socket.io.js"></script>
    <script type="text/javascript" src="Vortex.js"></script> 
    
    <script>
        $(function() {
            
			vx.start({verbose:false});

			vx.conectarPorWebSockets({
				url:'https://router-vortex.herokuapp.com' 
			});   
			
			
			var mi_clavePublica = vx.addKey('DonCarlosGutierres');
			console.log('mi_clavePublica', mi_clavePublica);
			
			
			
			$('#btn_setWhen').on('click',function(){
				vx.when({
					tipoDeMensaje: "test.jt.vx.when"
					
				},function(obj){
					
					console.log('me llego test.jt.vx.when: ', obj);
					
				});
			});
			$('#btn_setWhenPara').on('click',function(){
				
				vx.when({
					tipoDeMensaje: "test.jt.vx.when.para",
					para: mi_clavePublica
				},function(obj){
					console.log('me llego test.jt.vx.when.para: ', obj);
				});
			});
			
			$('#btn_setWhenPreguntaPara').on('click',function(){
				//////Esto lo haria un nodo lejano que quiere responder cosas
				vx.when({
					tipoDeMensaje: "test.jt.vx.when.pregunta.para"
				},function(obj){
					
					console.log('me llego test.jt.vx.when.pregunta.para: ', obj);
					
					vx.send({
						idRequest: obj.idRequest,
						para: obj.de,
						datoSeguroOriginal: obj.datoSeguro,
						loco: "las cosas son un flash"
					});
				});
			});
			
			
			
			
			
			$('#btn_setWhenParaPreguntaPara').on('click',function(){
				//////Esto lo haria un nodo lejano que quiere responder cosas
				vx.when({
					tipoDeMensaje: "test.jt.vx.when.para.pregunta.para",
					para: mi_clavePublica
				},function(obj){
					
					console.log('me llego test.jt.vx.when.para.pregunta.para: ', obj);
					
					vx.send({
						idRequest: obj.idRequest,
						para: obj.de,
						datoSeguroOriginal: obj.datoSeguro,
						loco: "las cosas son un flash"
					});
				});
			});
			
			
			
			$('#btn_setWhenParaPreguntaParaDe').on('click',function(){
				//////Esto lo haria un nodo lejano que quiere responder cosas
				vx.when({
					tipoDeMensaje: "test.jt.vx.when.para.pregunta.para.de",
					para: mi_clavePublica
				},function(obj){
					
					console.log('me llego test.jt.vx.when.para.pregunta.para.de: ', obj);
					
					vx.send({
						idRequest: obj.idRequest,
						de: mi_clavePublica,
						para: obj.de,
						datoSeguroOriginal: obj.datoSeguro,
						datoSeguro: {
							loco: "las cosas son un flash"
						}
					});
				});
			});
			/////////
			
			
			
				
			////////////
        });
    </script>

    <script type="text/javascript" src="phonegap.js"></script>
</html>